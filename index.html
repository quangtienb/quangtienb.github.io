<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hệ thống điều khiển thông gió cho nhà kính - Nhóm 20</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <style>
        /* Toàn bộ phần style giữ nguyên */
    </style>
</head>
<body>
    <header>
        <!-- Header giữ nguyên -->
    </header>

    <div class="led-banner">
        <span id="led-text">Chào mừng bạn đến với trang web Hệ thống điều khiển thông gió cho nhà kính của chúng tôi! 🌞</span>
    </div>

    <div class="controls">
        <div>
            <label for="speed-control">Tốc độ chạy chữ (1-20):</label>
            <input type="range" id="speed-control" min="1" max="20" value="12">
        </div>
        <div>
            <label for="color-control">Chọn màu nền LED:</label>
            <select id="color-control">
                <option value="black">⚫Đen</option>
                <option value="white">⚪Trắng</option>
                <!-- Các tùy chọn màu giữ nguyên -->
            </select>
        </div>
    </div>

    <section>
        <h2>🌈 Chọn Địa Điểm và Xem Thời Tiết</h2>
        <div>
            <label for="city-input">🌈 Nhập tên thành phố:</label>
            <input type="text" id="city-input" placeholder="Ví dụ: Hanoi, Ho Chi Minh...">
            <button id="fetch-weather-btn">Lấy dữ liệu thời tiết</button>
        </div>
        <div id="weather-info" class="weather-info-container">
            <!-- Các ô hiển thị thông tin thời tiết từ API -->
            <div class="weather-info">
                <i class="fas fa-temperature-high"></i>
                <h3>Nhiệt độ</h3>
                <p id="temperature">-- °C</p>
            </div>
            <!-- Các ô giữ nguyên -->
        </div>
    </section>

    <section>
        <h1>So sánh nhiệt độ</h1>
        <button onclick="compareTemperatures()">So sánh</button>
        <div id="result"></div>
    </section>

    <footer>
        <!-- Footer giữ nguyên -->
    </footer>

    <script src="https://www.gstatic.com/firebasejs/8.6.7/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.6.7/firebase-database.js"></script>

    <script>
        // Firebase configuration
        var firebaseConfig = {
            apiKey: "AIzaSyDe0ckQHkCBHGWQARoCTvIo1T1WEUHXlvk",
            authDomain: "demothoitiet-995b8.firebaseapp.com",
            databaseURL: "https://demothoitiet-995b8-default-rtdb.firebaseio.com",
            projectId: "demothoitiet-995b8",
            storageBucket: "demothoitiet-995b8.appspot.com",
            messagingSenderId: "823683238153",
            appId: "1:823683238153:web:97d52dd7ef86e50c616bd8",
            measurementId: "G-2JRE01LWSE"
        };
        firebase.initializeApp(firebaseConfig);

        var firebaseTempElement = document.getElementById('firebase-temp');
        var firebaseHumidityElement = document.getElementById('firebase-humidity');

        firebase.database().ref('DHT11/Temperature').on('value', function(snapshot) {
            firebaseTempElement.innerText = snapshot.val() + " °C";
        });

        firebase.database().ref('DHT11/Humidity').on('value', function(snapshot) {
            firebaseHumidityElement.innerText = snapshot.val() + " %";
        });

        // OpenWeather API
        var apiKey = 'c05417eac917208d896aa3f9cff02ac9';

        document.getElementById('fetch-weather-btn').addEventListener('click', function() {
            var city = document.getElementById('city-input').value;
            if (city) {
                var apiUrl = `https://api.openweathermap.org/data/2.5/weather?q=${city}&appid=${apiKey}&units=metric&lang=vi`;

                fetch(apiUrl)
                    .then(response => response.json())
                    .then(data => {
                        document.getElementById('temperature').innerText = `${data.main.temp}°C`;
                        document.getElementById('humidity').innerText = `${data.main.humidity}%`;
                        document.getElementById('wind-speed').innerText = `${data.wind.speed} m/s`;
                        document.getElementById('rainfall').innerText = `${data.rain?.['1h'] || 0} mm`;
                        document.getElementById('cloud-cover').innerText = `${data.clouds.all}%`;
                        document.getElementById('current-time').innerText = new Date().toLocaleTimeString();
                    })
                    .catch(error => console.error('Lỗi:', error));
            }
        });

        // So sánh nhiệt độ
        function compareTemperatures() {
            var firebaseTemp = parseFloat(firebaseTempElement.innerText);
            var apiTemp = parseFloat(document.getElementById('temperature').innerText);
            var weatherCondition = document.getElementById('rainfall').innerText;

            var resultMessage = '';

            if (firebaseTemp > apiTemp || parseFloat(weatherCondition) === 0) {
                resultMessage = 'Mở cửa thông gió';
            } else {
                resultMessage = 'Đóng cửa thông gió';
            }

            document.getElementById('result').innerText = resultMessage;
        }
    </script>
</body>
</html>
