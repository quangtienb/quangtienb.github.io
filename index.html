<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Há»‡ thá»‘ng Ä‘iá»u khiá»ƒn thÃ´ng giÃ³ cho nhÃ  kÃ­nh - NhÃ³m 20</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <style>
        /* ToÃ n bá»™ pháº§n style giá»¯ nguyÃªn */
    </style>
</head>
<body>
    <header>
        <!-- Header giá»¯ nguyÃªn -->
    </header>

    <div class="led-banner">
        <span id="led-text">ChÃ o má»«ng báº¡n Ä‘áº¿n vá»›i trang web Há»‡ thá»‘ng Ä‘iá»u khiá»ƒn thÃ´ng giÃ³ cho nhÃ  kÃ­nh cá»§a chÃºng tÃ´i! ğŸŒ</span>
    </div>

    <div class="controls">
        <div>
            <label for="speed-control">Tá»‘c Ä‘á»™ cháº¡y chá»¯ (1-20):</label>
            <input type="range" id="speed-control" min="1" max="20" value="12">
        </div>
        <div>
            <label for="color-control">Chá»n mÃ u ná»n LED:</label>
            <select id="color-control">
                <option value="black">âš«Äen</option>
                <option value="white">âšªTráº¯ng</option>
                <!-- CÃ¡c tÃ¹y chá»n mÃ u giá»¯ nguyÃªn -->
            </select>
        </div>
    </div>

    <section>
        <h2>ğŸŒˆ Chá»n Äá»‹a Äiá»ƒm vÃ  Xem Thá»i Tiáº¿t</h2>
        <div>
            <label for="city-input">ğŸŒˆ Nháº­p tÃªn thÃ nh phá»‘:</label>
            <input type="text" id="city-input" placeholder="VÃ­ dá»¥: Hanoi, Ho Chi Minh...">
            <button id="fetch-weather-btn">Láº¥y dá»¯ liá»‡u thá»i tiáº¿t</button>
        </div>
        <div id="weather-info" class="weather-info-container">
            <!-- CÃ¡c Ã´ hiá»ƒn thá»‹ thÃ´ng tin thá»i tiáº¿t tá»« API -->
            <div class="weather-info">
                <i class="fas fa-temperature-high"></i>
                <h3>Nhiá»‡t Ä‘á»™</h3>
                <p id="temperature">-- Â°C</p>
            </div>
            <!-- CÃ¡c Ã´ giá»¯ nguyÃªn -->
        </div>
    </section>

    <section>
        <h1>So sÃ¡nh nhiá»‡t Ä‘á»™</h1>
        <button onclick="compareTemperatures()">So sÃ¡nh</button>
        <div id="result"></div>
    </section>

    <footer>
        <!-- Footer giá»¯ nguyÃªn -->
    </footer>

    <script src="https://www.gstatic.com/firebasejs/8.6.7/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.6.7/firebase-database.js"></script>

    <script>
        // Firebase configuration
        var firebaseConfig = {
            apiKey: "AIzaSyDe0ckQHkCBHGWQARoCTvIo1T1WEUHXlvk",
            authDomain: "demothoitiet-995b8.firebaseapp.com",
            databaseURL: "https://demothoitiet-995b8-default-rtdb.firebaseio.com",
            projectId: "demothoitiet-995b8",
            storageBucket: "demothoitiet-995b8.appspot.com",
            messagingSenderId: "823683238153",
            appId: "1:823683238153:web:97d52dd7ef86e50c616bd8",
            measurementId: "G-2JRE01LWSE"
        };
        firebase.initializeApp(firebaseConfig);

        var firebaseTempElement = document.getElementById('firebase-temp');
        var firebaseHumidityElement = document.getElementById('firebase-humidity');

        firebase.database().ref('DHT11/Temperature').on('value', function(snapshot) {
            firebaseTempElement.innerText = snapshot.val() + " Â°C";
        });

        firebase.database().ref('DHT11/Humidity').on('value', function(snapshot) {
            firebaseHumidityElement.innerText = snapshot.val() + " %";
        });

        // OpenWeather API
        var apiKey = 'c05417eac917208d896aa3f9cff02ac9';

        document.getElementById('fetch-weather-btn').addEventListener('click', function() {
            var city = document.getElementById('city-input').value;
            if (city) {
                var apiUrl = `https://api.openweathermap.org/data/2.5/weather?q=${city}&appid=${apiKey}&units=metric&lang=vi`;

                fetch(apiUrl)
                    .then(response => response.json())
                    .then(data => {
                        document.getElementById('temperature').innerText = `${data.main.temp}Â°C`;
                        document.getElementById('humidity').innerText = `${data.main.humidity}%`;
                        document.getElementById('wind-speed').innerText = `${data.wind.speed} m/s`;
                        document.getElementById('rainfall').innerText = `${data.rain?.['1h'] || 0} mm`;
                        document.getElementById('cloud-cover').innerText = `${data.clouds.all}%`;
                        document.getElementById('current-time').innerText = new Date().toLocaleTimeString();
                    })
                    .catch(error => console.error('Lá»—i:', error));
            }
        });

        // So sÃ¡nh nhiá»‡t Ä‘á»™
        function compareTemperatures() {
            var firebaseTemp = parseFloat(firebaseTempElement.innerText);
            var apiTemp = parseFloat(document.getElementById('temperature').innerText);
            var weatherCondition = document.getElementById('rainfall').innerText;

            var resultMessage = '';

            if (firebaseTemp > apiTemp || parseFloat(weatherCondition) === 0) {
                resultMessage = 'Má»Ÿ cá»­a thÃ´ng giÃ³';
            } else {
                resultMessage = 'ÄÃ³ng cá»­a thÃ´ng giÃ³';
            }

            document.getElementById('result').innerText = resultMessage;
        }
    </script>
</body>
</html>
