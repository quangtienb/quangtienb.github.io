<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hệ thống điều khiển thông gió cho nhà kính - Nhóm 20</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <style>
        /* ... Toàn bộ CSS của bạn giữ nguyên ... */
    </style>
</head>
<body>
    <header>
        <h1>🌍 THÔNG TIN THỜI TIẾT 🌍</h1>
        <nav>
            <ul>
                <li><a href="gioithieu.html">🌤️ <b>Giới thiệu</b></a></li>
                <li><a href="yeucau.html">🌤️ <b>Yêu cầu</b></a></li>
                <li><a href="muctieu.html">🌤️ <b>Mục tiêu</b></a></li>
                <li><a href="lienhe.html">🌤️ <b>Liên hệ</b></a></li>
            </ul>
        </nav>
    </header>

    <section>
        <h2>🌈 Chọn Địa Điểm và Xem Thời Tiết</h2>
        <div>
            <label for="city-input">🌈 Nhập tên thành phố:</label>
            <input type="text" id="city-input" placeholder="Ví dụ: Hanoi, Ho Chi Minh...">
            <button id="fetch-weather-btn">Lấy dữ liệu thời tiết</button>
        </div>
        <p id="status-message" style="text-align: center; color: red;"></p>
        <div id="weather-info" class="weather-info-container">
            <!-- Giữ nguyên cấu trúc HTML -->
        </div>
    </section>

    <footer>
        <p>© 2024 Nhóm 20 - <a href="https://github.com/quangtienb" target="_blank">GitHub</a></p>
        <p><b>Bùi Quang Tiến - 21138184</b></p>
        <p><b>Nguyễn Ngọc Tân - 21138174</b></p>
        <p>Đồ án IoT và Ứng dụng</p>
    </footer>

    <script src="https://www.gstatic.com/firebasejs/8.6.7/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.6.7/firebase-database.js"></script>

    <script>
        // Firebase configuration
        var firebaseConfig = {
            apiKey: "AIzaSyDe0ckQHkCBHGWQARoCTvIo1T1WEUHXlvk",
            authDomain: "demothoitiet-995b8.firebaseapp.com",
            databaseURL: "https://demothoitiet-995b8-default-rtdb.firebaseio.com",
            projectId: "demothoitiet-995b8",
            storageBucket: "demothoitiet-995b8.appspot.com",
            messagingSenderId: "823683238153",
            appId: "1:823683238153:web:97d52dd7ef86e50c616bd8",
            measurementId: "G-2JRE01LWSE"
        };
        firebase.initializeApp(firebaseConfig);

        // Firebase: Lấy dữ liệu và cập nhật UI
        const firebaseTempElement = document.getElementById('firebase-temp');
        const firebaseHumidityElement = document.getElementById('firebase-humidity');
        firebase.database().ref('DHT11/Temperature').on('value', function(snapshot) {
            const temp = snapshot.val();
            firebaseTempElement.innerText = temp ? `${temp} °C` : "Không có dữ liệu";
        });
        firebase.database().ref('DHT11/Humidity').on('value', function(snapshot) {
            const humidity = snapshot.val();
            firebaseHumidityElement.innerText = humidity ? `${humidity} %` : "Không có dữ liệu";
        });

        // OpenWeather API: Lấy dữ liệu thời tiết
        const apiKey = 'c05417eac917208d896aa3f9cff02ac9';
        document.getElementById('fetch-weather-btn').addEventListener('click', function() {
            const city = document.getElementById('city-input').value.trim();
            const statusMessage = document.getElementById('status-message');
            if (city) {
                const apiUrl = `https://api.openweathermap.org/data/2.5/weather?q=${city}&appid=${apiKey}&units=metric&lang=vi`;
                statusMessage.innerText = "Đang tải dữ liệu...";
                fetch(apiUrl)
                    .then(response => {
                        if (!response.ok) throw new Error('Không tìm thấy thành phố');
                        return response.json();
                    })
                    .then(data => {
                        statusMessage.innerText = "";
                        document.getElementById('temperature').innerText = `${data.main.temp}°C`;
                        document.getElementById('humidity').innerText = `${data.main.humidity}%`;
                        document.getElementById('wind-speed').innerText = `${data.wind.speed} m/s`;
                        const rainfall = data.rain ? (data.rain['1h'] || 0) : 0;
                        document.getElementById('rainfall').innerText = `${rainfall} mm`;
                        document.getElementById('cloud-cover').innerText = `${data.clouds.all}%`;
                    })
                    .catch(error => {
                        statusMessage.innerText = error.message;
                    });
            } else {
                statusMessage.innerText = "Vui lòng nhập tên thành phố!";
            }
        });

        // Hiển thị thời gian thực
        function updateTime() {
            const now = new Date();
            const hours = String(now.getHours()).padStart(2, '0');
            const minutes = String(now.getMinutes()).padStart(2, '0');
            const seconds = String(now.getSeconds()).padStart(2, '0');
            document.getElementById('current-time').innerText = `${hours}:${minutes}:${seconds}`;
        }
        setInterval(updateTime, 1000);
    </script>
</body>
</html>
